# REQ-004-03: fanship ユースケース

## 概要

fanship（推し活管理アプリ）の主要なユースケースを定義する。

## アクター定義

| アクター | 説明 |
| -------- | ---- |
| ユーザー | fanshipを利用するユーザー |
| 閲覧者 | 共有リンク経由でコンテンツを閲覧する人 |

※認証はharborix基盤のSSOで行うため、未認証ユーザーのユースケースは省略

## ユースケース一覧

### 推し管理系

#### UC-001: 推しを登録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | ログイン済み |
| 基本フロー | 1. 推し管理画面を開く<br>2. 新規登録を選択<br>3. 名前、ジャンルを入力<br>4. プロフィール画像をアップロード（任意）<br>5. メモを入力（任意）<br>6. 保存ボタンを押す |
| 事後条件 | 推しが登録される |

#### UC-001a: 推しを一括登録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | ログイン済み |
| 基本フロー | 1. 推し管理画面を開く<br>2. 「一括登録」を選択<br>3. 共通のジャンルを選択（任意）<br>4. 「+行を追加」で入力行を追加<br>5. 各行に名前を入力<br>6. 「一括保存」ボタンを押す |
| 代替フロー | 4a. 不要な行は削除ボタンで削除 |
| 事後条件 | 複数の推しがまとめて登録される |

### イベント管理系

#### UC-002: イベントを登録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 推しが登録済み |
| 基本フロー | 1. イベント登録画面を開く<br>2. 対象の推しを選択<br>3. イベント名、種類を入力<br>4. 日時、場所を入力<br>5. チケット情報を入力（任意）<br>6. 保存ボタンを押す |
| 事後条件 | イベントがカレンダーに登録される |

#### UC-003: カレンダーでイベントを確認する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | イベントが登録済み |
| 基本フロー | 1. カレンダー画面を開く<br>2. 月/週表示を切り替え<br>3. 日付をタップしてイベント詳細を確認 |
| 事後条件 | なし |

#### UC-004: イベント参加を記録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | イベントが登録済み |
| 基本フロー | 1. イベント詳細を開く<br>2. 「参加済み」にステータス変更<br>3. 感想メモを入力（任意）<br>4. 保存する |
| 事後条件 | 参加履歴として記録される |

### グッズ管理系

#### UC-005: グッズを登録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 推しが登録済み |
| 基本フロー | 1. グッズ登録画面を開く<br>2. 対象の推しを選択<br>3. グッズ名、種類を入力<br>4. 購入日、金額を入力（任意）<br>5. 画像をアップロード（任意）<br>6. 保存ボタンを押す |
| 事後条件 | グッズがコレクションに登録される |

#### UC-005a: グッズを一括登録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 推しが登録済み |
| 基本フロー | 1. グッズ一覧画面を開く<br>2. 「一括登録」を選択<br>3. 共通の推し・種類を選択（任意）<br>4. 「+行を追加」で入力行を追加<br>5. 各行にグッズ名、金額等を入力<br>6. 「一括保存」ボタンを押す |
| 代替フロー | 4a. 不要な行は削除ボタンで削除<br>5a. 共通設定と異なる推し・種類は行ごとに上書き可能 |
| 事後条件 | 複数のグッズがまとめて登録される |

#### UC-006: グッズを検索・絞り込む

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | グッズが登録済み |
| 基本フロー | 1. グッズ一覧画面を開く<br>2. 検索キーワードを入力、または<br>3. 推し別/種類別フィルターを選択<br>4. 該当するグッズが表示される |
| 事後条件 | なし |

### 支出管理系

#### UC-007: 支出を記録する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | ログイン済み |
| 基本フロー | 1. 支出登録画面を開く<br>2. 対象の推しを選択（任意）<br>3. カテゴリを選択（グッズ、イベント、交通費等）<br>4. 金額を入力<br>5. 日付を指定<br>6. メモを入力（任意）<br>7. 保存ボタンを押す |
| 代替フロー | 5a. グッズ/イベント登録時に自動で支出登録 |
| 事後条件 | 支出が記録される |

#### UC-008: 支出統計を確認する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 支出が登録済み |
| 基本フロー | 1. 統計画面を開く<br>2. 期間を選択（月/年）<br>3. 推し別/カテゴリ別の集計が表示される<br>4. グラフで内訳を確認 |
| 事後条件 | なし |

### 共有系

#### UC-009: コンテンツを共有する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 推し/イベント/グッズが登録済み |
| 基本フロー | 1. 共有したいコンテンツを選択<br>2. 共有ボタンを押す<br>3. 公開範囲を設定（リンクを知っている人のみ等）<br>4. 共有リンクが生成される<br>5. リンクをコピー/SNSにシェア |
| 事後条件 | 共有リンクが有効になる |

#### UC-010: 共有コンテンツを閲覧する

| 項目 | 内容 |
| ---- | ---- |
| アクター | 閲覧者 |
| 事前条件 | 共有リンクを取得済み |
| 基本フロー | 1. 共有リンクにアクセス<br>2. コンテンツが表示される |
| 事後条件 | なし |

#### UC-011: 共有コンテンツをフォローする

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | 共有リンクにアクセス済み、ログイン済み |
| 基本フロー | 1. 共有コンテンツを閲覧<br>2. 「フォロー」ボタンを押す<br>3. フォロー一覧に追加される |
| 事後条件 | フォロー中のコンテンツとして登録される |

#### UC-012: フォロー中のコンテンツを確認する

| 項目 | 内容 |
| ---- | ---- |
| アクター | ユーザー |
| 事前条件 | フォロー中のコンテンツがある |
| 基本フロー | 1. ホーム画面でフォロー中の更新を確認<br>2. または、フォロー一覧画面を開く<br>3. フォロー中のコンテンツが表示される（リアルタイム更新） |
| 代替フロー | 3a. 共有元で更新があった場合、自動的に反映される |
| 事後条件 | なし |

## ユースケース図

```mermaid
graph TB
    subgraph アクター
        U[ユーザー]
        V[閲覧者]
    end

    subgraph 推し管理系
        UC001[UC-001: 推し登録]
    end

    subgraph イベント管理系
        UC002[UC-002: イベント登録]
        UC003[UC-003: カレンダー確認]
        UC004[UC-004: 参加記録]
    end

    subgraph グッズ管理系
        UC005[UC-005: グッズ登録]
        UC006[UC-006: グッズ検索]
    end

    subgraph 支出管理系
        UC007[UC-007: 支出記録]
        UC008[UC-008: 支出統計]
    end

    subgraph 共有系
        UC009[UC-009: コンテンツ共有]
        UC010[UC-010: 共有閲覧]
        UC011[UC-011: フォロー登録]
        UC012[UC-012: フォロー確認]
    end

    U --> UC001
    U --> UC002
    U --> UC003
    U --> UC004
    U --> UC005
    U --> UC006
    U --> UC007
    U --> UC008
    U --> UC009
    U --> UC011
    U --> UC012

    V --> UC010
```

## 推し活フロー図

```mermaid
sequenceDiagram
    participant U as ユーザー
    participant F as fanship
    participant V as 閲覧者

    Note over U,F: 推し登録フロー
    U->>F: 推しを登録
    F->>F: 推し情報保存

    Note over U,F: イベント管理フロー
    U->>F: イベント登録
    F->>F: カレンダーに追加
    U->>F: イベント参加
    F->>F: 参加履歴に記録
    F->>F: 支出自動記録

    Note over U,F: グッズ管理フロー
    U->>F: グッズ登録
    F->>F: コレクションに追加
    F->>F: 支出自動記録

    Note over U,V: 共有フロー
    U->>F: 共有リンク生成
    F->>U: 共有URL発行
    U->>V: リンクを共有
    V->>F: リンクにアクセス
    F->>V: コンテンツ表示
```

## フォロー・リアルタイム更新フロー図

```mermaid
sequenceDiagram
    participant U as ユーザー
    participant F as fanship
    participant WS as WebSocket
    participant S as 共有元ユーザー

    Note over U,S: フォロー登録フロー
    U->>F: 共有リンクにアクセス
    F->>U: コンテンツ表示
    U->>F: フォローボタン押下
    F->>F: フォロー情報保存
    F->>U: フォロー完了

    Note over U,S: リアルタイム更新フロー
    U->>WS: WebSocket接続確立
    S->>F: コンテンツを更新
    F->>F: データ保存
    F->>WS: 更新通知を配信
    WS->>U: リアルタイム通知
    U->>U: 画面自動更新

    Note over U,F: フォロー確認フロー
    U->>F: ホーム画面を開く
    F->>U: フォロー中の更新一覧を表示
    U->>F: フォロー詳細を開く
    F->>U: 最新状態を表示（リアルタイム）
```

## 変更履歴

- 2026-02-11: フォロー機能、リアルタイム更新フローを追加
- 2026-02-11: 初版作成
